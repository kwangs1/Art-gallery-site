<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.collectible">
	<resultMap id="goodsResult" type="collectibleVO">
		<result property="goods_id" column="goods_id" />
		<result property="goods_title" column="goods_title" />
		<result property="goods_year" column="goods_year" />
		<result property="goods_no" column="goods_no" />
		<result property="goods_author" column="goods_author" />
		<result property="goods_stuff" column="goods_stuff" />
		<result property="goods_standard" column="goods_standard" />
		<result property="goods_note" column="goods_note" />
		<result property="goods_status" column="goods_status" />
		<result property="goods_fileName" column="goods_fileName" />
	</resultMap>
		<!--상품 이미지 정보를 저장하는 resultmap  -->
	<resultMap id="imageResult" type="ImageFileVO">
	   <result property="goods_id" column="goods_id" />
	   <result property="fileName" column="fileName" />
	   <result property="reg_id" column="reg_id" />
	   <result property="image_id" column="image_id" />
	   <result property="fileType" column="fileType" />
	</resultMap>
	
	<select id="selectCollectibleList" parameterType="String" resultMap="goodsResult">
        <![CDATA[
			select col.goods_id,col.goods_title,col.goods_author,(image.fileName) as goods_fileName 
			from GALLERY_COLLECTIBLE col, GALLERY_IMAGE image
        	where col.goods_id=image.goods_id 
        	and image.filetype='main_image'
	    ]]>
	</select>
	
	<select id="selectCollectibleDetail" parameterType="String" resultMap="goodsResult" >
		<![CDATA[
			select col.goods_id, col.goods_title, col.goods_year, col.goods_no ,col.goods_author, col.goods_stuff, col.goods_standard,
			col.goods_note, col.goods_status, (image.fileName) as goods_fileName 
			from GALLERY_COLLECTIBLE col, GALLERY_IMAGE image
			where col.goods_id = image.goods_id
			and image.fileType = 'main_image'
			and col.goods_author = #{col.goods_author}
		]]>
	</select>
	
	<select id="selectCollectibleDetailImage" parameterType="String" resultMap="imageResult">
		<![CDATA[
			select * from gallery_image
			where
			fileType != 'main_image'
			and goods_id = #{goods_id}
		]]>
	</select>
</mapper>